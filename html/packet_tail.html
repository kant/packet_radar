<html>
<body>
    <style>
        body {
            font-family: monospace;
        }
        #holder {
            width: 100%;
            height: 100%;
        }

        .item {
            width: 100%;
            height: 20px;   
        }
    </style>

    <script src="js/packet_server.js"></script>
    <script src="js/stats.js"></script>

    <h2>Packet Logs</h2>
    <div id="holder">

    </div>
    <script>
        var tail_buffer = [];
        // Tail log
        connect_packet_server(data => {
            const src = data.src;
            const dst = data.dest;
            const len = data.len;
            console.log(data);

            var div = document.createElement('div');
            div.className = 'item';
            holder.appendChild(div);
            tail_buffer.push(div);
            div.innerText = `[${new Date().toLocaleString()}] ${src} > ${dst} (${len} bytes)`;

            if (tail_buffer.length > 100) {
                var last = tail_buffer.shift();
                last.remove();
            }

            div.scrollIntoView(false);
        });
    </script>
</body>
</html>